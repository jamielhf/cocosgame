window.__require=function e(t,n,r){function o(c,s){if(!n[c]){if(!t[c]){var i=c.split("/");if(i=i[i.length-1],!t[i]){var l="function"==typeof __require&&__require;if(!s&&l)return l(i,!0);if(a)return a(i,!0);throw new Error("Cannot find module '"+c+"'")}}var u=n[c]={exports:{}};t[c][0].call(u.exports,function(e){return o(t[c][1][e]||e)},u,u.exports,e,t,n,r)}return n[c].exports}for(var a="function"==typeof __require&&__require,c=0;c<r.length;c++)o(r[c]);return o}({launch:[function(e,t,n){"use strict";cc._RF.push(t,"e53e6YiUd9FJLf8yIQu1n47","launch"),cc.Class({extends:cc.Component,properties:{content:cc.Node,prefab:cc.Prefab},start:function(){var e=this,t=this;wx.onMessage(function(t){console.log(t.message),"updateMaxScore"===t.type&&e.updateMaxScore()}),wx.getUserInfo({openIdList:["selfOpenId"],lang:"zh_CN",success:function(e){console.log("success",e.data);e.data[0]},fail:function(e){reject(e)}}),wx.getFriendCloudStorage({keyList:["maxScore"],success:function(n){console.log(222,n);var r=n.data.filter(function(e,t,n){return e.KVDataList.length>0});console.log(333,r);var o=e.sortList(r);console.log(444,o);for(var a=o.length>5?5:o.length,c=0;c<a;c++){var s=o[c];s?t.createUserBlock(s):t.createPrefab()}},fail:function(e){console.error(e)}})},updateMaxScore:function(){wx.getUserCloudStorage({keyList:["maxScore"],success:function(e){console.log(e),(!(e=e.KVDataList)[1]||+e[1].value<+e[0].value)&&wx.setUserCloudStorage({KVDataList:[{key:"maxScore",value:e[0].value}],success:function(t){console.log("\u5b50\u57df\u66f4\u65b0\u6700\u9ad8\u5206\u6570",e[0].value)}})},fail:function(e){console.error(e)}})},createUserBlock:function(e){console.log(111,e);var t=this.createPrefab(),n=e.nickName?e.nickName:e.nickname,r=e.avatarUrl,o=t.getChildByName("userName").getComponent(cc.Label),a=t.getChildByName("score").getComponent(cc.Label),c=t.getChildByName("mask").children[0].getComponent(cc.Sprite);o.string=n,a.string=e.KVDataList?""+e.KVDataList[0].value:"0",console.log(n+"'s info has been getten."),cc.loader.load({url:r,type:"png"},function(e,t){e&&console.error(e),c.spriteFrame=new cc.SpriteFrame(t)})},createPrefab:function(){var e=cc.instantiate(this.prefab);return e.parent=this.content,e},sortList:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.sort(function(e,n){for(var r=0,o=e.KVDataList,a=0;a<o.length;a++)"score"==o[a].key&&(r=o[a].value);var c=0;o=n.KVDataList;for(a=0;a<o.length;a++)"score"==o[a].key&&(c=o[a].value);return t?parseInt(r)-parseInt(c):parseInt(c)-parseInt(r)}),e}}),cc._RF.pop()},{}]},{},["launch"]);